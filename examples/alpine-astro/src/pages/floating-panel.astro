---
import { floatingPanelControls, getControlDefaults } from "@zag-js/shared"
import ArrowDownLeft from "@lucide/astro/icons/arrow-down-left"
import Maximize2 from "@lucide/astro/icons/maximize-2"
import Minus from "@lucide/astro/icons/minus"
import XIcon from "@lucide/astro/icons/x"
import Layout from "../layouts/Layout.astro"
import Nav from "../components/Nav.astro"
import Toolbar from "../components/Toolbar.astro"
import Controls from "../components/Controls.astro"
import StateVisualizer from "../components/StateVisualizer.astro"

const state = getControlDefaults(floatingPanelControls)
---

<script>
  import * as floating from "@zag-js/floating-panel"
  import Alpine from "alpinejs"
  import { usePlugin } from "../lib"

  Alpine.plugin(usePlugin("floating", floating))
</script>

<Layout>
  <div class="page" x-data x-id="['floating']" x-floating="{id: $id('floating')}">
    <Nav />
    <main class="floating-panel">
      <div>
        <button x-floating:trigger>Toggle Panel</button>
        <div x-floating:positioner>
          <div x-floating:content>
            <div x-floating:drag-trigger>
              <div x-floating:header>
                <p x-floating:title>Floating Panel</p>
                <div x-floating:control>
                  <button x-floating:stage-trigger="{stage: 'minimized'}">
                    <Minus />
                  </button>
                  <button x-floating:stage-trigger="{stage: 'maximized'}">
                    <Maximize2 />
                  </button>
                  <button x-floating:stage-trigger="{stage: 'default'}">
                    <ArrowDownLeft />
                  </button>
                  <button x-floating:close-trigger>
                    <XIcon />
                  </button>
                </div>
              </div>
            </div>
            <div x-floating:body>
              <p>Some content</p>
            </div>

            <div x-floating:resize-trigger="{axis: 'n'}"></div>
            <div x-floating:resize-trigger="{axis: 'e'}"></div>
            <div x-floating:resize-trigger="{axis: 'w'}"></div>
            <div x-floating:resize-trigger="{axis: 's'}"></div>
            <div x-floating:resize-trigger="{axis: 'ne'}"></div>
            <div x-floating:resize-trigger="{axis: 'se'}"></div>
            <div x-floating:resize-trigger="{axis: 'sw'}"></div>
            <div x-floating:resize-trigger="{axis: 'nw'}"></div>
          </div>
        </div>
      </div>
    </main>

    <Toolbar>
      <Controls config={floatingPanelControls} {state} slot="controls" />
      <StateVisualizer />
    </Toolbar>
  </div>
</Layout>
