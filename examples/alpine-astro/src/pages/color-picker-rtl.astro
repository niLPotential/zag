---
import Nav from "../components/Nav.astro"
import Layout from "../layouts/Layout.astro"
---

<script>
  import * as colorPicker from "@zag-js/color-picker"
  import Alpine from "alpinejs"
  import { usePlugin } from "../lib"

  Alpine.magic("parse", () => {
    return (str: string) => colorPicker.parse(str)
  })
  Alpine.plugin(usePlugin("color-picker", colorPicker))
</script>

<Layout>
  <div
    class="page"
    x-data
    x-id="['color-picker']"
    x-color-picker="{
      id: $id('color-picker'),
      defaultValue: $parse('#3b82f6'),
      name: 'color',
      format: 'rgba',
      dir: 'rtl',
    }"
  >
    <Nav />
    <main class="color-picker">
      <form x-color-picker:root>
        <label x-color-picker:label x-text="$colorPicker.valueAsString"></label>
        <input x-color-picker:hidden-input />

        <div x-color-picker:control>
          <button x-color-picker:trigger>
            <div x-color-picker:transparency-grid="{size: '4px'}"></div>
            <div x-color-picker:swatch="{value: $colorPicker.value}"></div>
          </button>

          <input x-color-picker:channel-input="{channel: 'hex'}" />
          <input x-color-picker:channel-input="{channel: 'alpha'}" />
        </div>

        <div x-color-picker:positioner>
          <div x-color-picker:content>
            <div class="content__inner">
              <div x-color-picker:area>
                <div x-color-picker:area-background></div>
                <div x-color-picker:area-thumb></div>
              </div>

              <div x-color-picker:channel-slider="{channel: 'hue'}">
                <div x-color-picker:channel-slider-track="{channel: 'hue'}"></div>
                <div x-color-picker:channel-slider-thumb="{channel: 'hue'}"></div>
              </div>

              <div x-color-picker:channel-slider="{channel: 'alpha'}">
                <div x-color-picker:transparency-grid="{size: '8px'}"></div>
                <div x-color-picker:channel-slider-track="{channel: 'alpha'}"></div>
                <div x-color-picker:channel-slider-thumb="{channel: 'alpha'}"></div>
              </div>

              <div x-show="$colorPicker.format.startsWith('hsl')" style={{ display: "flex", width: "100%" }}>
                <span>H</span>
                <input x-color-picker:channel-input="{channel: 'hue'}" />
                <span>S</span>
                <input x-color-picker:channel-input="{channel: 'saturation'}" />
                <span>L</span>
                <input x-color-picker:channel-input="{channel: 'lightness'}" />
                <span>A</span>
                <input x-color-picker:channel-input="{channel: 'alpha'}" />
              </div>

              <div x-show="$colorPicker.format.startsWith('rgb')" style={{ display: "flex", width: "100%" }}>
                <span>R</span>
                <input x-color-picker:channel-input="{channel: 'red'}" />
                <span>G</span>
                <input x-color-picker:channel-input="{channel: 'green'}" />
                <span>B</span>
                <input x-color-picker:channel-input="{channel: 'blue'}" />
                <span>A</span>
                <input x-color-picker:channel-input="{channel: 'alpha'}" />
              </div>

              <div x-show="$colorPicker.format.startsWith('hsb')" style={{ display: "flex", width: "100%" }}>
                <span>H</span>
                <input x-color-picker:channel-input="{channel: 'hue'}" />
                <span>S</span>
                <input x-color-picker:channel-input="{channel: 'saturation'}" />
                <span>B</span>
                <input x-color-picker:channel-input="{channel: 'brightness'}" />
                <span>A</span>
                <input x-color-picker:channel-input="{channel: 'alpha'}" />
              </div>
            </div>
          </div>
        </div>
      </form>
    </main>
  </div>
</Layout>
