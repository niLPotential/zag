---
import Nav from "../components/Nav.astro"
import StateVisualizer from "../components/StateVisualizer.astro"
import Toolbar from "../components/Toolbar.astro"
import Layout from "../layouts/Layout.astro"
---

<script>
  import * as dialog from "@zag-js/dialog"
  import Alpine from "alpinejs"
  import { usePlugin } from "../lib"

  Alpine.plugin(usePlugin("dialog", dialog))
</script>

<Layout>
  <div class="page" x-data x-id="['dialog']">
    <Nav />
    <main>
      <div x-dialog="{id: $id('dialog')}">
        <button x-dialog:trigger data-testid="trigger-1"> Open Dialog </button>

        <div style={{ minHeight: "1200px" }}></div>

        <template x-if="$dialog.open">
          <div>
            <div x-dialog:backdrop></div>
            <div data-testid="positioner-1" x-dialog:positioner>
              <div x-dialog:content>
                <h2 x-dialog:title>Edit profile</h2>
                <p x-dialog:description>Make changes to your profile here. Click save when you are done.</p>
                <button x-dialog:close-trigger data-testid="close-1"> X </button>
                <input type="text" placeholder="Enter name..." data-testid="input-1" />
                <button data-testid="save-button-1">Save Changes</button>

                <div x-dialog="{id: $id('dialog')}">
                  <button x-dialog:trigger data-testid="trigger-2"> Open Nested </button>

                  <template x-if="$dialog.open">
                    <div>
                      <div x-dialog:backdrop></div>
                      <div data-testid="positioner-2" x-dialog:positioner>
                        <div x-dialog:content>
                          <h2 x-dialog:title>Nested</h2>
                          <button x-dialog:close-trigger data-testid="close-2"> X </button>
                          <button x-on:click="$dialog.setOpen(false)" data-testid="special-close">
                            Close Dialog 1
                          </button>
                        </div>
                      </div>
                    </div>
                  </template>
                </div>
              </div>
            </div>
          </div>
        </template>
      </div>
    </main>
    <Toolbar>
      <StateVisualizer label="Dialog 1" />
      <StateVisualizer label="Dialog 2" />
    </Toolbar>
  </div>
</Layout>
