---
import Nav from "../components/Nav.astro"
import StateVisualizer from "../components/StateVisualizer.astro"
import Toolbar from "../components/Toolbar.astro"
import Layout from "../layouts/Layout.astro"
---

<script>
  import * as dialog from "@zag-js/dialog"
  import Alpine from "alpinejs"
  import { usePlugin } from "../lib"

  Alpine.plugin(usePlugin("dialog-1", dialog))
  Alpine.plugin(usePlugin("dialog-2", dialog))
</script>

<Layout>
  <div class="page" x-data x-dialog-1="{id: 1}" x-dialog-2="{id: 2}">
    <Nav />
    <main>
      <div>
        <button x-dialog-1:trigger data-testid="trigger-1">Open Dialog</button>

        <div style={{ minHeight: "1200px" }}></div>

        <template x-if="$dialog1.open">
          <div>
            <div x-dialog-1:backdrop></div>
            <div data-testid="positioner-1" x-dialog-1:positioner>
              <div x-dialog-1:content>
                <h2 x-dialog-1:title>Edit profile</h2>
                <p x-dialog-1:description>Make changes to your profile here. Click save when you are done.</p>
                <button x-dialog-1:close-trigger data-testid="close-1">X</button>
                <input type="text" placeholder="Enter name..." data-testid="input-1" />
                <button data-testid="save-button-1">Save Changes</button>

                <button x-dialog-2:trigger data-testid="trigger-2">Open Nested</button>

                <template x-if="$dialog2.open">
                  <div>
                    <div x-dialog-2:backdrop></div>
                    <div data-testid="positioner-2" x-dialog-2:positioner>
                      <div x-dialog-2:content>
                        <h2 x-dialog-2:title>Nested</h2>
                        <button x-dialog-2:close-trigger data-testid="close-2">X</button>
                        <button x-on:click="$dialog1.setOpen(false)" data-testid="special-close">
                          Close Dialog 1
                        </button>
                      </div>
                    </div>
                  </div>
                </template>
              </div>
            </div>
          </div>
        </template>
      </div>
    </main>
    <Toolbar viz>
      <StateVisualizer label="dialog-1" />
      <StateVisualizer label="dialog-2" />
    </Toolbar>
  </div>
</Layout>
